<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>FastRecoveryCwnd.seq - The ssthresh and cwnd SHOULD NOT change while in Fast Recovery</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:root@localhost" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->
<!--

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#purpose">PURPOSE</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#pretest_condition">PRE-TEST CONDITION</a></li>
	<li><a href="#test_procedure">TEST PROCEDURE</a></li>
	<li><a href="#note">NOTE</a></li>
	<li><a href="#reference">REFERENCE</a></li>
</ul>
-->
<!-- INDEX END -->

<p>
</p>
<h1><a name="name">NAME</a></h1>
<pre>
  FastRecoveryCwnd.seq - The ssthresh and cwnd SHOULD NOT change while in Fast Recovery</pre>
<p>
</p>
<hr />
<h1><a name="purpose">PURPOSE</a></h1>
<pre>
  To check that while in Fast Recovery, the ssthresh and cwnd SHOULD NOT
  change for any destinations due to a subsequent Fast Recovery event.</pre>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<PRE>
  <A HREF="./FastRecoveryCwnd.seq">./FastRecoveryCwnd.seq</A> [-tooloption ...] -pkt <A HREF="./FastRecoveryCwnd.def">./FastRecoveryCwnd.def</A>
    -tooloption : v6eval tool option
  See Also: <A HREF="../common/STD_PKT_COMMON.def">../common/STD_PKT_COMMON.def</A>
            <A HREF="../common/SCTP_COMMON.def">../common/SCTP_COMMON.def</A>
</PRE><p>
</p>
<hr />
<h1><a name="pretest_condition">PRE-TEST CONDITION</a></h1>
<pre>
  Association is established between endpoint A and B. Arrange data 
  in endpoint B such that messages is sent to endpoint A.</pre>
<p>
</p>
<hr />
<h1><a name="test_procedure">TEST PROCEDURE</a></h1>
<pre>
  Endpoint A                           Endpoint B                ULP
  (ESTABLISHED)                        (ESTABLISHED)</pre>
<pre>
                &lt;-----------------      DATA 1</pre>
<pre>
                &lt;-----------------      DATA 2</pre>
<pre>
                &lt;-----------------      DATA 3</pre>
<pre>
                &lt;-----------------      DATA 4</pre>
<pre>
                &lt;-----------------      DATA 5</pre>
<pre>
  SACK          -----------------&gt;
  (From DATA 1 to DATA 5)
                &lt;-----------------      DATA 1</pre>
<pre>
                &lt;-----------------      DATA 2</pre>
<pre>
                &lt;-----------------      DATA 3</pre>
<pre>
                &lt;-----------------      DATA 4</pre>
<pre>
                &lt;-----------------      DATA 5</pre>
<pre>
                &lt;-----------------      DATA 6</pre>
<pre>
  SACK          -----------------&gt;
  (From DATA 1 to DATA 6)
                &lt;-----------------      DATA 1</pre>
<pre>
                &lt;-----------------      DATA 2</pre>
<pre>
                &lt;-----------------      DATA 3</pre>
<pre>
                &lt;-----------------      DATA 4</pre>
<pre>
                &lt;-----------------      DATA 5</pre>
<pre>
                &lt;-----------------      DATA 6</pre>
<pre>
                &lt;-----------------      DATA 7</pre>
<pre>
  SACK          -----------------&gt;
  (From DATA 1 to DATA 7)
                &lt;-----------------      DATA 1</pre>
<pre>
                &lt;-----------------      DATA 2</pre>
<pre>
                &lt;-----------------      DATA 3</pre>
<pre>
                &lt;-----------------      DATA 4</pre>
<pre>
                &lt;-----------------      DATA 5</pre>
<pre>
                &lt;-----------------      DATA 6</pre>
<pre>
                &lt;-----------------      DATA 7</pre>
<pre>
                &lt;-----------------      DATA 8</pre>
<pre>
  SACK          -----------------&gt;
  (From DATA 1 to DATA 8)
                &lt;-----------------      DATA 1</pre>
<pre>
                &lt;-----------------      DATA 2</pre>
<pre>
                &lt;-----------------      DATA 3</pre>
<pre>
                &lt;-----------------      DATA 4</pre>
<pre>
                &lt;-----------------      DATA 5</pre>
<pre>
                &lt;-----------------      DATA 6</pre>
<pre>
                &lt;-----------------      DATA 7</pre>
<pre>
                &lt;-----------------      DATA 9</pre>
<pre>
  SACK          -----------------&gt;
  (From DATA 1 to DATA 9)
                &lt;-----------------      DATA 1</pre>
<pre>
                &lt;-----------------      DATA 2</pre>
<pre>
                &lt;-----------------      DATA 3</pre>
<pre>
                &lt;-----------------      DATA 4</pre>
<pre>
                &lt;-----------------      DATA 5</pre>
<pre>
                &lt;-----------------      DATA 6</pre>
<pre>
                &lt;-----------------      DATA 7</pre>
<pre>
                &lt;-----------------      DATA 10</pre>
<pre>
  SACK          -----------------&gt;
  (From DATA 1 to DATA 10)
                &lt;-----------------      DATA 1</pre>
<pre>
                &lt;-----------------      DATA 2</pre>
<pre>
                &lt;-----------------      DATA 3</pre>
<pre>
                &lt;-----------------      DATA 4</pre>
<pre>
                &lt;-----------------      DATA 5</pre>
<pre>
                &lt;-----------------      DATA 6</pre>
<pre>
                &lt;-----------------      DATA 7</pre>
<pre>
                &lt;-----------------      DATA 11</pre>
<pre>
  SACK          -----------------&gt;
  (From DATA 1 to DATA 11)
                &lt;-----------------      DATA 1</pre>
<pre>
                &lt;-----------------      DATA 2</pre>
<pre>
                &lt;-----------------      DATA 3</pre>
<pre>
                &lt;-----------------      DATA 4</pre>
<pre>
                &lt;-----------------      DATA 5</pre>
<pre>
                &lt;-----------------      DATA 6</pre>
<pre>
                &lt;-----------------      DATA 7</pre>
<pre>
                &lt;-----------------      DATA 12</pre>
<pre>
  SACK          -----------------&gt;
  (From DATA 1 to DATA 12)
                &lt;-----------------      DATA 1</pre>
<pre>
                &lt;-----------------      DATA 2</pre>
<pre>
                &lt;-----------------      DATA 3</pre>
<pre>
                &lt;-----------------      DATA 4</pre>
<pre>
                &lt;-----------------      DATA 5</pre>
<pre>
                &lt;-----------------      DATA 6</pre>
<pre>
                &lt;-----------------      DATA 7</pre>
<pre>
                &lt;-----------------      DATA 12</pre>
<pre>
  SACK          -----------------&gt;
  (For DATA 1)
  SACK          -----------------&gt;
  (For DATA 1, DATA4)
  SACK          -----------------&gt;
  (For DATA 1, DATA4, DATA5)
  SACK          -----------------&gt;
  (For DATA 1, DATA4, DATA5, DATA6)
                &lt;-----------------      DATA 2
                                        (Fast Retransmit)
  SACK          -----------------&gt;
  (For DATA 2, DATA4, DATA5, DATA6)
                &lt;-----------------      DATA 3
                                        (Fast Recovery)
  SACK          -----------------&gt;
  (Form DATA 2 to DATA12)
                &lt;-----------------      DATA 13</pre>
<pre>
  SACK          -----------------&gt;
  (For DATA 13)</pre>
<pre>
  TEST DESCRIPTION:</pre>
<pre>
  1. Check A: the initial cwnd before DATA transmission is set to 4380.
  2. From endpoint B, send valid DATA message 69 times to endpoint A,
     when there is association between them.
  3. From endpoint A, receive DATA message 5 times and send SACK of the
     5 DATA messages to endpoint B.
  4. Check B: the initial cwnd after DATA transmission is set to 5880.
  5. From endpoint A, receive DATA message 6 times and send SACK of the
     6 DATA messages to endpoint B.
  6. Check C: the initial cwnd after DATA transmission is set to 7380.
  7. From endpoint A, receive DATA message 7 times and send SACK of the
     7 DATA messages to endpoint B.
  8. Check D: the initial cwnd after DATA transmission is set to 8880.
  9. From endpoint A, receive DATA message 8 times and send SACK of the
     8 DATA messages to endpoint B.
  10.Check E: the initial cwnd after DATA transmission is set to 10380.
  11.From endpoint A, receive DATA message 9 times and send SACK of the
     9 DATA messages to endpoint B.
  12.Check F: the initial cwnd after DATA transmission is set to 11880.
  13.From endpoint A, receive DATA message 10 times and send SACK of the
     10 DATA messages to endpoint B.
  14.Check G: the initial cwnd after DATA transmission is set to 13380.
  15.From endpoint A, receive DATA message 11 times and send SACK of the
     11 DATA messages to endpoint B.
  16.Check H: the initial cwnd after DATA transmission is set to 14880.
  17.From endpoint A, receive DATA message 12 times.
  18.From endpoint A, send SACK of the 1st DATA message to endpoint B.
  19.From endpoint A, send SACK of the 1st, 4th DATA messages to endpoint 
     B, report the 2nd and 3rd messages are missing.
  20.From endpoint A, send SACK of the 1st, 4th and 5th DATA messages to
     endpoint B, report the 2nd and 3rd messages are missing.
  21.From endpoint A, send SACK of the 1st, 4th to 6th DATA messages to
     endpoint B, report the 2nd and 3rd messages are missing.
  22.The 2nd DATA messages is send again immediately.
  23.Check H: the initial cwnd after DATA transmission is set to 7440.
  24.From endpoint A, send SACK of the 2nd, 4th to 6th DATA messages to
     endpoint B, report the 3rd message is missing.
  25.The 3rd DATA messages is send again immediately.
  26.Check I: the initial cwnd SHOULD NOT change.
  27.From endpoint A, send SACK of all the received DATA messages.</pre>
<p>
</p>
<hr />
<h1><a name="note">NOTE</a></h1>
<pre>
  None</pre>
<p>
</p>
<hr />
<h1><a name="reference">REFERENCE</a></h1>
<pre>
  RFC 4960</pre>
<pre>
  7.2.4.  Fast Retransmit on Gap Reports</pre>
<pre>
    When the third consecutive miss indication is received for a TSN(s),
    the data sender shall do the following:</pre>
<pre>
    1)  Mark the DATA chunk(s) with three miss indications for
        retransmission.</pre>
<pre>
    2)  If not in Fast Recovery, adjust the ssthresh and cwnd of the
        destination address(es) to which the missing DATA chunks were
        last sent, according to the formula described in Section 7.2.3.</pre>
<pre>
    3)  Determine how many of the earliest (i.e., lowest TSN) DATA chunks
        marked for retransmission will fit into a single packet, subject
        to constraint of the path MTU of the destination transport
        address to which the packet is being sent.  Call this value K.
        Retransmit those K DATA chunks in a single packet.  When a Fast
        Retransmit is being performed, the sender SHOULD ignore the value
        of cwnd and SHOULD NOT delay retransmission for this single
        packet.</pre>
<pre>
    4)  Restart the T3-rtx timer only if the last SACK acknowledged the
        lowest outstanding TSN number sent to that address, or the
        endpoint is retransmitting the first outstanding DATA chunk sent
        to that address.</pre>
<pre>
    5)  Mark the DATA chunk(s) as being fast retransmitted and thus
        ineligible for a subsequent Fast Retransmit.  Those TSNs marked
        for retransmission due to the Fast-Retransmit algorithm that did
        not fit in the sent datagram carrying K other TSNs are also
        marked as ineligible for a subsequent Fast Retransmit.  However,
        as they are marked for retransmission they will be retransmitted
        later on as soon as cwnd allows.</pre>
<PRE>
    6)  If not in Fast Recovery, enter Fast Recovery and mark the highest
        outstanding TSN as the Fast Recovery exit point.  When a SACK
        acknowledges all TSNs up to and including this exit point, Fast
        Recovery is exited.  <B>While in Fast Recovery, the ssthresh and
        cwnd SHOULD NOT change for any destinations due to a subsequent
        Fast Recovery event (i.e., one SHOULD NOT reduce the cwnd further
        due to a subsequent Fast Retransmit).</B>
</PRE><pre>
    Note: Before the above adjustments, if the received SACK also
    acknowledges new DATA chunks and advances the Cumulative TSN Ack
    Point, the cwnd adjustment rules defined in Section 7.2.1 and Section
    7.2.2 must be applied first.</pre>
<pre>
    A straightforward implementation of the above keeps a counter for
    each TSN hole reported by a SACK.  The counter increments for each
    consecutive SACK reporting the TSN hole.  After reaching 3 and
    starting the Fast-Retransmit procedure, the counter resets to 0.

</pre>

</body>

</html>
